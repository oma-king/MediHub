<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add Prescription Form</title>
</head>
<body>
<h2>Add Prescription Form</h2>
<form id="addPrescriptionForm">
    <label for="title">Title:</label>
    <input type="text" id="title" name="title" required><br><br>

    <label for="prescriptionDate">Prescription Date:</label>
    <input type="date" id="prescriptionDate" name="prescriptionDate" required><br><br>

    <label for="description">Description:</label>
    <input type="text" id="description" name="description" required><br><br>

    <label for="itemList">Item List:</label>
    <input type="text" id="itemList" name="itemList" required><br><br>

    <button type="submit">Add Prescription</button>
</form>

<!-- Script to handle form submission -->
<script>
    document.getElementById("addPrescriptionForm").addEventListener("submit", function(event) {
        event.preventDefault(); // Prevent default form submission
        let urlParams = new URLSearchParams(window.location.search);
        let ConsultationId = urlParams.get("ConsultationId");
        // Collect form data
        let formData = {
            title: document.getElementById("title").value,
            prescriptionDate: document.getElementById("prescriptionDate").value,
            description: document.getElementById("description").value,
            itemList: document.getElementById("itemList").value,
            consultationId: ConsultationId,
        };

        // Send data to backend via AJAX
        fetch('/addPrescription', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
            .then(response => response.text())
            .then(message => {
                alert(message); // Show success message
                // Optionally redirect or perform other actions after adding prescription
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Failed to add prescription');
            });
    });
</script>
</body>
</html>
